           from section_engagement\n            )\n        select\n            pe.org as org,\n            pe.course_key as course_key,\n            course_blocks.course_run as course_run,\n            course_blocks.display_name_with_location as section_subsection_name,\n            pe.content_level as content_level,\n            pe.actor_id as actor_id,\n            pe.section_subsection_problem_engagement\n            as section_subsection_problem_engagement,\n            users.username as username,\n            users.name as name,\n            users.email as email\n        from problem_engagement pe\n        join\n            reporting.dim_course_blocks course_blocks\n            on (\n                pe.org = course_blocks.org\n                and pe.course_key = course_blocks.course_key\n                and pe.block_id = course_blocks.block_id\n            )\n        left outer join\n            reporting.dim_user_pii users\n            on (pe.actor_id like \'mailto:%\' and SUBSTRING(pe.actor_id, 8) = users.email)\n            or pe.actor_id = toString(users.external_user_id)\n        where\n            1 = 1\n            {% if filter_values(\"org\") != [] %}\n                and org in {{ filter_values(\"org\") | where_in }}\n            {% endif %}\n\n            {% if filter_values(\"course_name\") != [] %}\n                and course_key in (\n                    select course_key\n                    from event_sink.course_names\n                    where course_name in {{ filter_values(\"course_name\") | where_in }}\n                )\n            {% endif %}\n\n            {% if filter_values(\"tag\") != [] %}\n                and course_key in (\n                    select course_key\n                    from reporting.most_recent_course_tags\n                    where\n                        tag in (\n                            select\n                                replaceAll(\n                                    arrayJoin({{ filter_values(\"tag\") }}), \'- \', \'\'\n                                )\n                        )\n                )\n            {% endif %}\n    )\nselect fact_problem_engagement.*\nfrom fact_problem_engagement pe\njoin\n    (\n        with\n            page_visits as (\n                select org, course_key, actor_id, max(emission_time) as last_visited\n                from xapi.fact_learner_last_course_visit\n                where\n                    1 = 1\n                    {% if filter_values(\"org\") != [] %}\n                        and org in {{ filter_values(\"org\") | where_in }}\n                    {% endif %}\n\n                    {% if filter_values(\"course_name\") != [] %}\n                        and course_key in (\n                            select course_key\n                            from event_sink.course_names\n                            where\n                                course_name\n                                in {{ filter_values(\"course_name\") | where_in }}\n                        )\n                    {% endif %}\n\n                    {% if filter_values(\"tag\") != [] %}\n                        and course_key in (\n                            select course_key\n                            from reporting.most_recent_course_tags\n                            where\n                                tag in (\n                                    select\n                                        replaceAll(\n                                            arrayJoin({{ filter_values(\"tag\") }}),\n                                            \'- \',\n                                            \'\'\n                                        )\n                                )\n                        )\n                    {% endif %}\n                    and emission_time < subtractDays(now(), 7)\n                group by org, course_key, actor_id\n            )\n\n        select org, course_key, learners.actor_id as actor_id\n        from reporting.fact_student_status learners\n        join page_visits using (org, course_key, actor_id)\n        where\n            approving_state = \'failed\' and enrollment_status = \'registered\'\n            {% if filter_values(\"org\") != [] %}\n                and org in {{ filter_values(\"org\") | where_in }}\n            {% endif %}\n\n            {% if filter_values(\"course_name\") != [] %}\n                and course_key in (\n                    select course_key\n                    from event_sink.course_names\n                    where course_name in {{ filter_values(\"course_name\") | where_in }}\n                )\n            {% endif %}\n\n            {% if filter_values(\"tag\") != [] %}\n                and course_key in (\n                    select course_key\n                    from reporting.most_recent_course_tags\n                    where\n                        tag in (\n                            select\n                                replaceAll(\n                                    arrayJoin({{ filter_values(\"tag\") }}), \'- \', \'\'\n                                )\n                        )\n                )\n            {% endif %}\n    ) as at_risk_learners\n    on (\n        pe.org = at_risk_learners.org\n        and pe.course_key = at_risk_learners.course_key\n        and pe.actor_id = at_risk_learners.actor_id\n    )\n',NULL,'[OpenedX Clickhouse].[fact_at_risk_problem_engagement_el](id:589)',0,NULL,0,'{}','[OpenedX Clickhouse].[reporting]',NULL,_binary 'vôΩ˚W&\\ªêûPª™s\0',0,NULL,1,0),('2025-01-10 06:45:42','2025-01-14 07:53:10',590,'clickhouse_computed_metrics_tr_TR',NULL,NULL,1,1,1,0,NULL,0,NULL,'system','select name, toFloat64(value) as value, description\nfrom system.metrics\nwhere metric in (\'Query\', \'DelayedInserts\', \'DistributedFilesToInsert\')\n\nunion all\n\nselect metric as name, round(toFloat64(value), 2) as value, description\nfrom system.asynchronous_metrics\nwhere metric in (\'MaxPartCountForPartition\', \'Uptime\')\n\nunion all\n\nselect name, toFloat64(value) as value, description\nfrom system.events\nwhere\n    event in (\n        \'RejectedInserts\',\n        \'ReplicatedDataLoss\',\n        \'DataAfterMergeDiffersFromReplica\',\n        \'DataAfterMutationDiffersFromReplica\'\n    )\n\nunion all\n\nselect\n    \'StuckReplicationTasks\' as name,\n    toFloat64(count()) as value,\n    \'Replication tasks that were retried or postponed over 100 times.\' as description\nfrom system.replication_queue\nwhere num_tries > 100 or num_postponed > 100\n\nunion all\n\nselect\n    CONCAT(\'cluster \', name) as name,\n    ROUND(SUM(free_space) / SUM(total_space), 3) * 100 as value,\n    \'Free space per cluster node, as percent\' as description\nfrom system.disks\ngroup by name\n',NULL,'[OpenedX Clickhouse].[clickhouse_computed_metrics_tr_TR](id:590)',1,NULL,0,NULL,'[OpenedX Clickhouse].[system]','{}',_binary 'Æ†˙ÜN\ÍRèºT\Ímâç\“F',0,NULL,0,0),('2025-01-10 06:45:42','2025-01-14 07:53:10',591,'indexed_events_de_DE','emission_time',NULL,1,1,1,0,NULL,0,NULL,'xapi','with\n    events as (\n        select\n            event_id,\n            CAST(emission_time, \'DateTime\') as emission_time,\n            actor_id,\n            object_id,\n            splitByString(\'/\', course_id)[-1] as course_key,\n            org,\n            verb_id\n        from xapi.xapi_events_all_parsed\n    )\n\nselect\n    courses.course_name as course_name,\n    courses.course_run as course_run,\n    event_id,\n    actor_id,\n    object_id,\n    events.course_key,\n    events.org,\n    events.verb_id,\n    emission_time\nfrom events\njoin event_sink.course_names courses on (events.course_key = courses.course_key)\n',NULL,'[OpenedX Clickhouse].[indexed_events_de_DE](id:591)',1,NULL,0,NULL,'[OpenedX Clickhouse].[xapi]','{}',_binary '!#|\⁄Dç^K™¥\ﬁ\Ì∏0\À\–',0,NULL,0,0),('2025-01-10 06:45:42','2025-01-14 07:53:10',592,'fact_enrollment_status_id','emission_time',NULL,1,1,1,0,NULL,0,NULL,'reporting','select * from reporting.fact_enrollment_status\n',NULL,'[OpenedX Clickhouse].[fact_enrollment_status_id](id:592)',1,NULL,0,NULL,'[OpenedX Clickhouse].[reporting]',NULL,_binary '\È\Ô8\„û\\ŸùD\n\ÿ(í£/',0,NULL,0,0),('2025-01-10 06:45:42','2025-01-14 07:53:10',593,'fact_navigation_completion_en','visited_on',NULL,1,1,1,0,NULL,0,NULL,'reporting','select *\nfrom reporting.fact_navigation_completion\nwhere\n    1 = 1\n    {% if filter_values(\"org\") != [] %}\n        and org in {{ filter_values(\"org\") | where_in }}\n    {% endif %}\n\n    {% if filter_values(\"course_name\") != [] %}\n        and course_key in (\n            select course_key\n            from event_sink.course_names\n            where course_name in {{ filter_values(\"course_name\") | where_in }}\n        )\n    {% endif %}\n\n    {% if filter_values(\"tag\") != [] %}\n        and course_key in (\n            select course_key\n            from reporting.most_recent_course_tags\n            where\n                tag\n                in (select replaceAll(arrayJoin({{ filter_values(\"tag\") }}), \'- \', \'\'))\n        )\n    {% endif %}\n',NULL,'[OpenedX Clickhouse].[fact_navigation_completion_en](id:593)',1,NULL,0,NULL,'[OpenedX Clickhouse].[reporting]',NULL,_binary 'U6\n\ny\ÙY\ˆã\ŒNˇ\‡Má7',0,NULL,0,0),('2025-01-10 06:45:42','2025-01-14 07:53:10',594,'fact_at_risk_problem_engagement_es_ES',NULL,NULL,1,1,1,0,NULL,0,NULL,'reporting','with\n    fact_problem_engagement as (\n        with\n            subsection_engagement as (\n                select\n                    org,\n                    course_key,\n                    \'subsection\' as content_level,\n                    actor_id,\n                    subsection_block_id as block_id,\n                    engagement_level as section_subsection_problem_engagement\n                from xapi.subsection_problem_engagement\n                where\n                    1 = 1\n                    {% if filter_values(\"org\") != [] %}\n                        and org in {{ filter_values(\"org\") | where_in }}\n                    {% endif %}\n\n                    {% if filter_values(\"course_name\") != [] %}\n                        and course_key in (\n                            select course_key\n                            from event_sink.course_names\n                            where\n                                course_name\n                                in {{ filter_values(\"course_name\") | where_in }}\n                        )\n                    {% endif %}\n\n                    {% if filter_values(\"tag\") != [] %}\n                        and course_key in (\n                            select course_key\n                            from reporting.most_recent_course_tags\n                            where\n                                tag in (\n                                    select\n                                        replaceAll(\n                                            arrayJoin({{ filter_values(\"tag\") }}),\n                                            \'- \',\n                                            \'\'\n                                        )\n                                )\n                        )\n                    {% endif %}\n\n            ),\n            section_engagement as (\n                select\n                    org,\n                    course_key,\n                    \'section\' as content_level,\n                    actor_id,\n                    section_block_id as block_id,\n                    engagement_level as section_subsection_problem_engagement\n                from xapi.section_problem_engagement\n                where\n                    1 = 1\n                    {% if filter_values(\"org\") != [] %}\n                        and org in {{ filter_values(\"org\") | where_in }}\n                    {% endif %}\n\n                    {% if filter_values(\"course_name\") != [] %}\n                        and course_key in (\n                            select course_key\n                            from event_sink.course_names\n                            where\n                                course_name\n                                in {{ filter_values(\"course_name\") | where_in }}\n                        )\n                    {% endif %}\n\n                    {% if filter_values(\"tag\") != [] %}\n                        and course_key in (\n                            select course_key\n                            from reporting.most_recent_course_tags\n                            where\n                                tag in (\n                                    select\n                                        replaceAll(\n                                            arrayJoin({{ filter_values(\"tag\") }}),\n                                            \'- \',\n                                            \'\'\n                                        )\n                                )\n                        )\n                    {% endif %}\n            ),\n            problem_engagement as (\n                select *\n                from subsection_engagement\n                union all\n                select *\n                from section_engagement\n            )\n        select\n            pe.org as org,\n            pe.course_key as course_key,\n            course_blocks.course_run as course_run,\n            course_blocks.display_name_with_location as section_subsection_name,\n            pe.content_level as content_level,\n            pe.actor_id as actor_id,\n            pe.section_subsection_problem_engagement\n            as section_subsection_problem_engagement,\n            users.username as username,\n            users.name as name,\n            users.email as email\n        from problem_engagement pe\n        join\n            reporting.dim_course_blocks course_blocks\n            on (\n                pe.org = course_blocks.org\n                and pe.course_key = course_blocks.course_key\n                and pe.block_id = course_blocks.block_id\n            )\n        left outer join\n            reporting.dim_user_pii users\n            on (pe.actor_id like \'mailto:%\' and SUBSTRING(pe.actor_id, 8) = users.email)\n            or pe.actor_id = toString(users.external_user_id)\n        where\n            1 = 1\n            {% if filter_values(\"org\") != [] %}\n                and org in {{ filter_values(\"org\") | where_in }}\n            {% endif %}\n\n            {% if filter_values(\"course_name\") != [] %}\n                and course_key in (\n                    select course_key\n                    from event_sink.course_names\n                    where course_name in {{ filter_values(\"course_name\") | where_in }}\n                )\n            {% endif %}\n\n            {% if filter_values(\"tag\") != [] %}\n                and course_key in (\n                    select course_key\n                    from reporting.most_recent_course_tags\n                    where\n                        tag in (\n                            select\n                                replaceAll(\n                                    arrayJoin({{ filter_values(\"tag\") }}), \'- \', \'\'\n                                )\n                        )\n                )\n            {% endif %}\n    )\nselect fact_problem_engagement.*\nfrom fact_problem_engagement pe\njoin\n    (\n        with\n            page_visits as (\n                select org, course_key, actor_id, max(emission_time) as last_visited\n                from xapi.fact_learner_last_course_visit\n                where\n                    1 = 1\n                    {% if filter_values(\"org\") != [] %}\n                        and org in {{ filter_values(\"org\") | where_in }}\n                    {% endif %}\n\n                    {% if filter_values(\"course_name\") != [] %}\n                        and course_key in (\n                            select course_key\n                            from event_sink.course_names\n                            where\n                                course_name\n                                in {{ filter_values(\"course_name\") | where_in }}\n                        )\n                    {% endif %}\n\n                    {% if filter_values(\"tag\") != [] %}\n                        and course_key in (\n                            select course_key\n                            from reporting.most_recent_course_tags\n                            where\n                                tag in (\n                                    select\n                                        replaceAll(\n                                            arrayJoin({{ filter_values(\"tag\") }}),\n                                            \'- \',\n                                            \'\'\n                                        )\n                                )\n                        )\n                    {% endif %}\n                    and emission_time < subtractDays(now(), 7)\n                group by org, course_key, actor_id\n            )\n\n        select org, course_key, learners.actor_id as actor_id\n        from reporting.fact_student_status learners\n        join page_visits using (org, course_key, actor_id)\n        where\n            approving_state = \'failed\' and enrollment_status = \'registered\'\n            {% if filter_values(\"org\") != [] %}\n                and org in {{ filter_values(\"org\") | where_in }}\n            {% endif %}\n\n            {% if filter_values(\"course_name\") != [] %}\n                and course_key in (\n                    select course_key\n                    from event_sink.course_names\n                    where course_name in {{ filter_values(\"course_name\") | where_in }}\n                )\n            {% endif %}\n\n            {% if filter_values(\"tag\") != [] %}\n                and course_key in (\n                    select course_key\n                    from reporting.most_recent_course_tags\n                    where\n                        tag in (\n                            select\n                                replaceAll(\n                                    arrayJoin({{ filter_values(\"tag\") }}), \'- \', \'\'\n                                )\n                        )\n                )\n            {% endif %}\n    ) as at_risk_learners\n    on (\n        pe.org = at_risk_learners.org\n        and pe.course_key = at_risk_learners.course_key\n        and pe.actor_id = at_risk_learners.actor_id\n    )\n',NULL,'[OpenedX Clickhouse].[fact_at_risk_problem_engagement_es_ES](id:594)',0,NULL,0,'{}','[OpenedX Clickhouse].[reporting]',NULL,_binary 'AÆ‹Ü\ÏXW¢ûVDu\Û¥',0,NULL,1,0),('2025-01-10 06:45:42','2025-01-14 07:53:10',595,'learner_summary_fr_CA','emission_time',NULL,1,1,1,0,NULL,0,NULL,'reporting','with\n    latest_emission_time as (\n        select org, course_key, actor_id, MAX(emission_time) as last_visited\n        from xapi.fact_learner_last_course_visit\n        where\n            1 = 1\n            {% if filter_values(\"org\") != [] %}\n                and org in {{ filter_values(\"org\") | where_in }}\n            {% endif %}\n\n            {% if filter_values(\"course_name\") != [] %}\n                and course_key in (\n                    select course_key\n                    from event_sink.course_names\n                    where course_name in {{ filter_values(\"course_name\") | where_in }}\n                )\n            {% endif %}\n\n            {% if filter_values(\"tag\") != [] %}\n                and course_key in (\n                    select course_key\n                    from reporting.most_recent_course_tags\n                    where\n                        tag in (\n                            select\n                                replaceAll(\n                                    arrayJoin({{ filter_values(\"tag\") }}), \'- \', \'\'\n                                )\n                        )\n                )\n            {% endif %}\n            {% if filter_values(\"username\") != [] or filter_values(\n                \"name\"\n            ) != [] or filter_values(\"email\") != [] %}\n                and actor_id in (\n                    select external_user_id::String\n                    from event_sink.user_pii\n                    where\n                        1 = 1\n                        {% if filter_values(\"username\") != [] %}\n                            and username in {{ filter_values(\"username\") | where_in }}\n                        {% endif %}\n                        {% if filter_values(\"name\") != [] %}\n                            and name in {{ filter_values(\"name\") | where_in }}\n                        {% endif %}\n                        {% if filter_values(\"email\") != [] %}\n                            and email in {{ filter_values(\"email\") | where_in }}\n                        {% endif %}\n                )\n            {% endif %}\n        group by org, course_key, actor_id\n    ),\n    enrollment_status as (\n        select org, course_key, actor_id, MAX(emission_time) as max_emission_time\n        from reporting.fact_enrollment_status\n        where\n            1 = 1\n            {% if filter_values(\"org\") != [] %}\n                and org in {{ filter_values(\"org\") | where_in }}\n            {% endif %}\n\n            {% if filter_values(\"course_name\") != [] %}\n                and course_key in (\n                    select course_key\n                    from event_sink.course_names\n                    where course_name in {{ filter_values(\"course_name\") | where_in }}\n                )\n            {% endif %}\n\n            {% if filter_values(\"tag\") != [] %}\n                and course_key in (\n                    select course_key\n                    from reporting.most_recent_course_tags\n                    where\n                        tag in (\n                            select\n                                replaceAll(\n                                    arrayJoin({{ filter_values(\"tag\") }}), \'- \', \'\'\n                                )\n                        )\n                )\n            {% endif %}\n            {% if filter_values(\"username\") != [] or filter_values(\n                \"name\"\n            ) != [] or filter_values(\"email\") != [] %}\n                and actor_id in (\n                    select external_user_id::String\n                    from event_sink.user_pii\n                    where\n                        1 = 1\n                        {% if filter_values(\"username\") != [] %}\n                            and username in {{ filter_values(\"username\") | where_in }}\n                        {% endif %}\n                        {% if filter_values(\"name\") != [] %}\n                            and name in {{ filter_values(\"name\") | where_in }}\n                        {% endif %}\n                        {% if filter_values(\"email\") != [] %}\n                            and email in {{ filter_values(\"email\") | where_in }}\n                        {% endif %}\n                )\n            {% endif %}\n        group by org, course_key, actor_id\n    ),\n    student_status as (\n        select\n            fss.org as org,\n            fss.course_key as course_key,\n            fss.actor_id as actor_id,\n            fss.course_name as course_name,\n            fss.course_run as course_run,\n            fss.approving_state as approving_state,\n            fss.enrollment_mode as enrollment_mode,\n            fss.enrollment_status as enrollment_status,\n            fss.course_grade as course_grade,\n            fss.grade_bucket as grade_bucket,\n            fss.username as username,\n            fss.name as name,\n            fss.email as email,\n            fss.enrolled_at as enrolled_at\n        from reporting.fact_student_status fss\n        where\n            1 = 1\n            {% if filter_values(\"org\") != [] %}\n                and org in {{ filter_values(\"org\") | where_in }}\n            {% endif %}\n\n            {% if filter_values(\"course_name\") != [] %}\n                and course_key in (\n                    select course_key\n                    from event_sink.course_names\n                    where course_name in {{ filter_values(\"course_name\") | where_in }}\n                )\n            {% endif %}\n\n            {% if filter_values(\"tag\") != [] %}\n                and course_key in (\n                    select course_key\n                    from reporting.most_recent_course_tags\n                    where\n                        tag in (\n                            select\n                                replaceAll(\n                                    arrayJoin({{ filter_values(\"tag\") }}), \'- \', \'\'\n                                )\n                        )\n                )\n            {% endif %}\n            {% if filter_values(\"username\") != [] or filter_values(\n                \"name\"\n            ) != [] or filter_values(\"email\") != [] %}\n                and actor_id in (\n                    select external_user_id::String\n                    from event_sink.user_pii\n                    where\n                        1 = 1\n                        {% if filter_values(\"username\") != [] %}\n                            and username in {{ filter_values(\"username\") | where_in }}\n                        {% endif %}\n                        {% if filter_values(\"name\") != [] %}\n                            and name in {{ filter_values(\"name\") | where_in }}\n                        {% endif %}\n                        {% if filter_values(\"email\") != [] %}\n                            and email in {{ filter_values(\"email\") | where_in }}\n                        {% endif %}\n                )\n            {% endif %}\n    )\nselect\n    fss.org as org,\n    fss.course_key as course_key,\n    fss.actor_id as actor_id,\n    fss.course_name as course_name,\n    fss.course_run as course_run,\n    fss.approving_state as approving_state,\n    fss.enrollment_mode as enrollment_mode,\n    fss.enrollment_status as enrollment_status,\n    fss.course_grade as course_grade,\n    fss.grade_bucket as grade_bucket,\n    fss.username as username,\n    fss.name as name,\n    fss.email as email,\n    fes.max_emission_time as emission_time,\n    GREATEST(let.last_visited, fss.enrolled_at) as last_visited\nfrom student_status fss\nleft join\n    enrollment_status fes\n    on fss.org = fes.org\n    and fss.course_key = fes.course_key\n    and fss.actor_id = fes.actor_id\nleft join\n    latest_emission_time let\n    on fss.org = let.org\n    and fss.course_key = let.course_key\n    and fss.actor_id = let.actor_id\nwhere\n    1 = 1\n    {% if filter_values(\"org\") != [] %}\n        and org in {{ filter_values(\"org\") | where_in }}\n    {% endif %}\n\n    {% if filter_values(\"course_name\") != [] %}\n        and course_key in (\n            select course_key\n            from event_sink.course_names\n            where course_name in {{ filter_values(\"course_name\") | where_in }}\n        )\n    {% endif %}\n\n    {% if filter_values(\"tag\") != [] %}\n        and course_key in (\n            select course_key\n            from reporting.most_recent_course_tags\n            where\n                tag\n                in (select replaceAll(arrayJoin({{ filter_values(\"tag\") }}), \'- \', \'\'))\n        )\n    {% endif %}\n',NULL,'[OpenedX Clickhouse].[learner_summary_fr_CA](id:595)',1,NULL,0,NULL,'[OpenedX Clickhouse].[reporting]',NULL,_binary 'éw ãøK^ô\"\ƒ\0*∑t~',0,NULL,0,0),('2025-01-10 06:45:43','2025-01-14 07:53:10',596,'fact_at_risk_video_plays','emission_time',NULL,1,1,1,0,NULL,0,NULL,'reporting','with\n    video_plays as (\n        with\n            plays as (\n                select *\n                from reporting.fact_video_plays\n                where\n\n                    {% if get_filters(\"course_name\", remove_filter=True) == [] %} 1 = 1\n                    {% elif filter_values(\"course_name\") != [] %}\n                        course_name in {{ filter_values(\"course_name\") | where_in }}\n                    {% else %} 1 = 0\n                    {% endif %}\n\n                    {% if filter_values(\"org\") != [] %}\n                        and org in {{ filter_values(\"org\") | where_in }}\n                    {% endif %}\n\n                    {% if filter_values(\"course_name\") != [] %}\n                        and course_key in (\n                            select course_key\n                            from event_sink.course_names\n                            where\n                                course_name\n                                in {{ filter_values(\"course_name\") | where_in }}\n                        )\n                    {% endif %}\n\n                    {% if filter_values(\"tag\") != [] %}\n                        and course_key in (\n                            select course_key\n                            from reporting.most_recent_course_tags\n                            where\n                                tag in (\n                                    select\n                                        replaceAll(\n                                            arrayJoin({{ filter_values(\"tag\") }}),\n                                            \'- \',\n                                            \'\'\n                                        )\n                                )\n                        )\n                    {% endif %}\n            )\n\n        select *\n        from plays\n    )\n\nselect video_plays.*\nfrom video_plays\njoin\n    (\n        with\n            page_visits as (\n                select org, course_key, actor_id, max(emission_time) as last_visited\n                from xapi.fact_learner_last_course_visit\n                where\n                    1 = 1\n                    {% if filter_values(\"org\") != [] %}\n                        and org in {{ filter_values(\"org\") | where_in }}\n                    {% endif %}\n\n                    {% if filter_values(\"course_name\") != [] %}\n                        and course_key in (\n                            select course_key\n                            from event_sink.course_names\n                            where\n                                course_name\n                                in {{ filter_values(\"course_name\") | where_in }}\n                        )\n                    {% endif %}\n\n                    {% if filter_values(\"tag\") != [] %}\n                        and course_key in (\n                            select course_key\n                            from reporting.most_recent_course_tags\n                            where\n                                tag in (\n                                    select\n                                        replaceAll(\n                                            arrayJoin({{ filter_values(\"tag\") }}),\n                                            \'- \',\n                                            \'\'\n                                        )\n                                )\n                        )\n                    {% endif %}\n                    and emission_time < subtractDays(now(), 7)\n                group by org, course_key, actor_id\n            )\n\n        select org, course_key, learners.actor_id as actor_id\n        from reporting.fact_student_status learners\n        join page_visits using (org, course_key, actor_id)\n        where\n            approving_state = \'failed\' and enrollment_status = \'registered\'\n            {% if filter_values(\"org\") != [] %}\n                and org in {{ filter_values(\"org\") | where_in }}\n            {% endif %}\n\n            {% if filter_values(\"course_name\") != [] %}\n                and course_key in (\n                    select course_key\n                    from event_sink.course_names\n                    where course_name in {{ filter_values(\"course_name\") | where_in }}\n                )\n            {% endif %}\n\n            {% if filter_values(\"tag\") != [] %}\n                and course_key in (\n                    select course_key\n                    from reporting.most_recent_course_tags\n                    where\n                        tag in (\n                            select\n                                replaceAll(\n                                    arrayJoin({{ filter_values(\"tag\") }}), \'- \', \'\'\n                                )\n                        )\n                )\n            {% endif %}\n    ) as at_risk_learners using (org, course_key, actor_id)\nwhere\n    1 = 1\n    {% if filter_values(\"org\") != [] %}\n        and org in {{ filter_values(\"org\") | where_in }}\n    {% endif %}\n\n    {% if filter_values(\"course_name\") != [] %}\n        and course_key in (\n            select course_key\n            from event_sink.course_names\n            where course_name in {{ filter_values(\"course_name\") | where_in }}\n        )\n    {% endif %}\n\n    {% if filter_values(\"tag\") != [] %}\n        and course_key in (\n            select course_key\n            from reporting.most_recent_course_tags\n            where\n                tag\n                in (select replaceAll(arrayJoin({{ filter_values(\"tag\") }}), \'- \', \'\'))\n        )\n    {% endif %}\n',NULL,'[OpenedX Clickhouse].[fact_at_risk_video_plays](id:596)',0,NULL,0,'{}','[OpenedX Clickhouse].[reporting]','{}',_binary '\‰6\Ôä`JB©\Ÿ9\Á\œ)ˇ\Ï',0,NULL,1,0),('2025-01-10 06:45:43','2025-01-14 07:53:10',597,'slowest_clickhouse_queries_en','event_time',NULL,1,1,1,0,NULL,0,NULL,'system','select\n    event_time,\n    query_duration_ms / 1000 as duration_secs,\n    read_rows,\n    memory_usage / 1024 as memory_usage_kb,\n    query\nfrom system.query_log\nwhere type = \'QueryFinish\'\norder by query_duration_ms DESC\n;\n',NULL,'[OpenedX Clickhouse].[slowest_clickhouse_queries_en](id:597)',1,NULL,0,NULL,'[OpenedX Clickhouse].[system]','{}',_binary '\ÿ\ˆõD\ÚRNï\X$.]î1',0,NULL,0,0),('2025-01-10 06:45:43','2025-01-14 07:53:10',598,'fact_problem_engagement_zh_CN',NULL,NULL,1,1,1,0,NULL,0,NULL,'reporting','with\n    subsection_engagement as (\n        select\n            org,\n            course_key,\n            \'subsection\' as content_level,\n            actor_id,\n            subsection_block_id as block_id,\n            engagement_level as section_subsection_problem_engagement\n        from xapi.subsection_problem_engagement\n        where\n            1 = 1\n            {% if filter_values(\"org\") != [] %}\n                and org in {{ filter_values(\"org\") | where_in }}\n            {% endif %}\n\n            {% if filter_values(\"course_name\") != [] %}\n                and course_key in (\n                    select course_key\n                    from event_sink.course_names\n                    where course_name in {{ filter_values(\"course_name\") | where_in }}\n                )\n            {% endif %}\n\n            {% if filter_values(\"tag\") != [] %}\n                and course_key in (\n                    select course_key\n                    from reporting.most_recent_course_tags\n                    where\n                        tag in (\n                            select\n                                replaceAll(\n                                    arrayJoin({{ filter_values(\"tag\") }}), \'- \', \'\'\n                                )\n                        )\n                )\n            {% endif %}\n\n    ),\n    section_engagement as (\n        select\n            org,\n            course_key,\n            \'section\' as content_level,\n            actor_id,\n            section_block_id as block_id,\n            engagement_level as section_subsection_problem_engagement\n        from xapi.section_problem_engagement\n        where\n            1 = 1\n            {% if filter_values(\"org\") != [] %}\n                and org in {{ filter_values(\"org\") | where_in }}\n            {% endif %}\n\n            {% if filter_values(\"course_name\") != [] %}\n                and course_key in (\n                    select course_key\n                    from event_sink.course_names\n                    where course_name in {{ filter_values(\"course_name\") | where_in }}\n                )\n            {% endif %}\n\n            {% if filter_values(\"tag\") != [] %}\n                and course_key in (\n                    select course_key\n                    from reporting.most_recent_course_tags\n                    where\n                        tag in (\n                            select\n                                replaceAll(\n                                    arrayJoin({{ filter_values(\"tag\") }}), \'- \', \'\'\n                                )\n                        )\n                )\n            {% endif %}\n    ),\n    problem_engagement as (\n        select *\n        from subsection_engagement\n        union all\n        select *\n        from section_engagement\n    )\nselect\n    pe.org as org,\n    pe.course_key as course_key,\n    course_blocks.course_run as course_run,\n    course_blocks.display_name_with_location as section_subsection_name,\n    pe.content_level as content_level,\n    pe.actor_id as actor_id,\n    pe.section_subsection_problem_engagement as section_subsection_problem_engagement,\n    users.username as username,\n    users.name as name,\n    users.email as email\nfrom problem_engagement pe\njoin\n    reporting.dim_course_blocks course_blocks\n    on (\n        pe.org = course_blocks.org\n        and pe.course_key = course_blocks.course_key\n        and pe.block_id = course_blocks.block_id\n    )\nleft outer join\n    reporting.dim_user_pii users\n    on (pe.actor_id like \'mailto:%\' and SUBSTRING(pe.actor_id, 8) = users.email)\n    or pe.actor_id = toString(users.external_user_id)\nwhere\n    1 = 1\n    {% if filter_values(\"org\") != [] %}\n        and org in {{ filter_values(\"org\") | where_in }}\n    {% endif %}\n\n    {% if filter_values(\"course_name\") != [] %}\n        and course_key in (\n            select course_key\n            from event_sink.course_names\n            where course_name in {{ filter_values(\"course_name\") | where_in }}\n        )\n    {% endif %}\n\n    {% if filter_values(\"tag\") != [] %}\n        and course_key in (\n            select course_key\n            from reporting.most_recent_course_tags\n            where\n                tag\n                in (select replaceAll(arrayJoin({{ filter_values(\"tag\") }}), \'- \', \'\'))\n        )\n    {% endif %}\n',NULL,'[OpenedX Clickhouse].[fact_problem_engagement_zh_CN](id:598)',0,NULL,0,'{}','[OpenedX Clickhouse].[reporting]',NULL,_binary '\‡=\Œ&L*\\7Ø•\Ò9\r',0,NULL,1,0),('2025-01-10 06:45:43','2025-01-14 07:53:10',599,'clickhouse_computed_metrics_it_IT',NULL,NULL,1,1,1,0,NULL,0,NULL,'system','select name, toFloat64(value) as value, description\nfrom system.metrics\nwhere metric in (\'Query\', \'DelayedInserts\', \'DistributedFilesToInsert\')\n\nunion all\n\nselect metric as name, round(toFloat64(value), 2) as value, description\nfrom system.asynchronous_metrics\nwhere metric in (\'MaxPartCountForPartition\', \'Uptime\')\n\nunion all\n\nselect name, toFloat64(value) as value, description\nfrom system.events\nwhere\n    event in (\n        \'RejectedInserts\',\n        \'ReplicatedDataLoss\',\n        \'DataAfterMergeDiffersFromReplica\',\n        \'DataAfterMutationDiffersFromReplica\'\n    )\n\nunion all\n\nselect\n    \'StuckReplicationTasks\' as name,\n    toFloat64(count()) as value,\n    \'Replication tasks that were retried or postponed over 100 times.\' as description\nfrom system.replication_queue\nwhere num_tries > 100 or num_postponed > 100\n\nunion all\n\nselect\n    CONCAT(\'cluster \', name) as name,\n    ROUND(SUM(free_space) / SUM(total_space), 3) * 100 as value,\n    \'Free space per cluster node, as percent\' as description\nfrom system.disks\ngroup by name\n',NULL,'[OpenedX Clickhouse].[clickhouse_computed_metrics_it_IT](id:599)',1,NULL,0,NULL,'[OpenedX Clickhouse].[system]','{}',_binary '…≠ó-:SI´û•£ut',0,NULL,0,0),('2025-01-10 06:45:43','2025-01-14 07:53:10',600,'fact_pageview_engagement_tr_TR',NULL,NULL,1,1,1,0,NULL,0,NULL,'reporting','with\n    subsection_engagement as (\n        select\n            org,\n            course_key,\n            \'subsection\' as content_level,\n            actor_id,\n            subsection_block_id as block_id,\n            engagement_level as section_subsection_page_engagement\n        from xapi.subsection_page_engagement\n        where\n            1 = 1\n            {% if filter_values(\"org\") != [] %}\n                and org in {{ filter_values(\"org\") | where_in }}\n            {% endif %}\n\n            {% if filter_values(\"course_name\") != [] %}\n                and course_key in (\n                    select course_key\n                    from event_sink.course_names\n                    where course_name in {{ filter_values(\"course_name\") | where_in }}\n                )\n            {% endif %}\n\n            {% if filter_values(\"tag\") != [] %}\n                and course_key in (\n                    select course_key\n                    from reporting.most_recent_course_tags\n                    where\n                        tag in (\n                            select\n                                replaceAll(\n                                    arrayJoin({{ filter_values(\"tag\") }}), \'- \', \'\'\n                                )\n                        )\n                )\n            {% endif %}\n    ),\n    section_engagement as (\n        select\n            org,\n            course_key,\n            \'section\' as content_level,\n            actor_id,\n            section_block_id as block_id,\n            engagement_level as section_subsection_page_engagement\n        from xapi.section_page_engagement\n    ),\n    page_engagement as (\n        select *\n        from subsection_engagement\n        union all\n        select *\n        from section_engagement\n    )\n\nselect\n    pv.org as org,\n    pv.course_key as course_key,\n    course_blocks.course_run as course_run,\n    course_blocks.display_name_with_location as section_subsection_name,\n    pv.content_level as content_level,\n    pv.actor_id as actor_id,\n    pv.section_subsection_page_engagement as section_subsection_page_engagement,\n    users.username as username,\n    users.name as name,\n    users.email as email\nfrom page_engagement pv\njoin\n    reporting.dim_course_blocks course_blocks\n    on (\n        pv.org = course_blocks.org\n        and pv.course_key = course_blocks.course_key\n        and pv.block_id = course_blocks.block_id\n    )\nleft outer join\n    reporting.dim_user_pii users\n    on (pv.actor_id like \'mailto:%\' and SUBSTRING(pv.actor_id, 8) = users.email)\n    or pv.actor_id = toString(users.external_user_id)\nwhere\n    1 = 1\n    {% if filter_values(\"org\") != [] %}\n        and org in {{ filter_values(\"org\") | where_in }}\n    {% endif %}\n\n    {% if filter_values(\"course_name\") != [] %}\n        and course_key in (\n            select course_key\n            from event_sink.course_names\n            where course_name in {{ filter_values(\"course_name\") | where_in }}\n        )\n    {% endif %}\n\n    {% if filter_values(\"tag\") != [] %}\n        and course_key in (\n            select course_key\n            from reporting.most_recent_course_tags\n            where\n                tag\n                in (select replaceAll(arrayJoin({{ filter_values(\"tag\") }}), \'- \', \'\'))\n        )\n    {% endif %}\n',NULL,'[OpenedX Clickhouse].[fact_pageview_engagement_tr_TR](id:600)',0,NULL,0,'{}','[OpenedX Clickhouse].[reporting]',NULL,_binary 'ns∑ãÉ4Yúñ\\\ŸACÕ≥',0,NULL,1,0),('2025-01-10 06:45:43','2025-01-14 07:53:10',601,'fact_enrollment_pii_uk',NULL,NULL,1,1,1,0,NULL,0,NULL,'reporting','with\n    enrollments as (\n        select\n            enrollment.actor_id,\n            enrollment.course_key,\n            enrollment.org,\n            course_names.course_name as course_name\n        from reporting.fact_enrollment_status enrollment\n        inner join\n            event_sink.course_names as course_names\n            -- Need to cast the course key to a string here otherwise the\n            -- course_names dictionary throws this:\n            -- Key type for complex key at position 0 does not match, expected String,\n            -- found LowCardinality(String).\n            on course_names.course_key = enrollment.course_key::String\n        where\n            1 = 1\n            {% if filter_values(\"org\") != [] %}\n                and org in {{ filter_values(\"org\") | where_in }}\n            {% endif %}\n\n            {% if filter_values(\"course_name\") != [] %}\n                and course_key in (\n                    select course_key\n                    from event_sink.course_names\n                    where course_name in {{ filter_values(\"course_name\") | where_in }}\n                )\n            {% endif %}\n\n            {% if filter_values(\"tag\") != [] %}\n                and course_key in (\n                    select course_key\n                    from reporting.most_recent_course_tags\n                    where\n                        tag in (\n                            select\n                                replaceAll(\n                                    arrayJoin({{ filter_values(\"tag\") }}), \'- \', \'\'\n                                )\n                        )\n                )\n            {% endif %}\n    )\n\nselect\n    users.username as username,\n    users.email as email,\n    users.name as name,\n    enrollments.org as org,\n    enrollments.course_key as course_key,\n    enrollments.course_name as course_name\nfrom enrollments\ninner join\n    reporting.dim_user_pii as users\n    on (\n        enrollments.actor_id like \'mailto:%\'\n        and SUBSTRING(enrollments.actor_id, 8) = users.email\n    )\n    or enrollments.actor_id = toString(users.external_user_id)\n',NULL,'[OpenedX Clickhouse].[fact_enrollment_pii_uk](id:601)',1,NULL,0,NULL,'[OpenedX Clickhouse].[reporting]',NULL,_binary '\≈/\ÁÑUX¢±h8õp™f9',0,NULL,0,0),('2025-01-10 06:45:43','2025-01-14 07:53:11',602,'fact_watched_video_segments_hi','started_at',NULL,1,1,1,0,NULL,0,NULL,'reporting','with\n    video_events as (\n        select\n            emission_time,\n            org,\n            course_key,\n            splitByString(\'/xblock/\', object_id)[-1] as video_id,\n            object_id,\n            actor_id,\n            verb_id,\n            video_position,\n            video_duration\n        from xapi.video_playback_events\n        where\n            1 = 1\n            {% if filter_values(\"org\") != [] %}\n                and org in {{ filter_values(\"org\") | where_in }}\n            {% endif %}\n\n            {% if filter_values(\"course_name\") != [] %}\n                and course_key in (\n                    select course_key\n                    from event_sink.course_names\n                    where course_name in {{ filter_values(\"course_name\") | where_in }}\n                )\n            {% endif %}\n\n            {% if filter_values(\"tag\") != [] %}\n                and course_key in (\n                    select course_key\n                    from reporting.most_recent_course_tags\n                    where\n                        tag in (\n                            select\n                                replaceAll(\n                                    arrayJoin({{ filter_values(\"tag\") }}), \'- \', \'\'\n                                )\n                        )\n                )\n            {% endif %}\n    ),\n    starts as (\n        select *\n        from video_events\n        where verb_id = \'https://w3id.org/xapi/video/verbs/played\'\n    ),\n    ends as (\n        select *\n        from video_events\n        where\n            verb_id in (\n                \'http://adlnet.gov/expapi/verbs/completed\',\n                \'https://w3id.org/xapi/video/verbs/seeked\',\n                \'https://w3id.org/xapi/video/verbs/paused\',\n                \'http://adlnet.gov/expapi/verbs/terminated\'\n            )\n    ),\n    segments as (\n        select\n            starts.org as org,\n            starts.course_key as course_key,\n            starts.video_id as video_id,\n            starts.actor_id,\n            starts.object_id as object_id,\n            cast(starts.video_position as Int32) as start_position,\n            cast(ends.video_position as Int32) as end_position,\n            starts.emission_time as started_at,\n            ends.emission_time as ended_at,\n            ends.verb_id as end_type,\n            starts.video_duration as video_duration\n        from starts left\n        asof join\n            ends\n            on (\n                starts.org = ends.org\n                and starts.course_key = ends.course_key\n                and starts.video_id = ends.video_id\n                and starts.actor_id = ends.actor_id\n                and starts.emission_time < ends.emission_time\n            )\n    ),\n    enriched_segments as (\n        select\n            segments.org as org,\n            segments.course_key as course_key,\n            blocks.course_name as course_name,\n            blocks.course_run as course_run,\n            blocks.section_with_name as section_with_name,\n            blocks.subsection_with_name as subsection_with_name,\n            blocks.block_name as video_name,\n            blocks.display_name_with_location as video_name_with_location,\n            segments.actor_id as actor_id,\n            segments.object_id as object_id,\n            segments.started_at as started_at,\n            segments.start_position - (segments.start_position % 5) as start_position,\n            segments.end_position - (segments.end_position % 5) as end_position,\n            segments.video_duration as video_duration,\n            segments.video_id as video_id\n        from segments\n        join\n            reporting.dim_course_blocks_extended blocks\n            on (\n                segments.course_key = blocks.course_key\n                and segments.video_id = blocks.block_id\n            )\n        where\n            1 = 1\n            {% if filter_values(\"org\") != [] %}\n                and org in {{ filter_values(\"org\") | where_in }}\n            {% endif %}\n\n            {% if filter_values(\"course_name\") != [] %}\n                and course_key in (\n                    select course_key\n                    from event_sink.course_names\n                    where course_name in {{ filter_values(\"course_name\") | where_in }}\n                )\n            {% endif %}\n\n            {% if filter_values(\"tag\") != [] %}\n                and course_key in (\n                    select course_key\n  